<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apartment Scorer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="top-nav">
        <div class="nav-content">
            <h1 class="logo">üè¢ ApartmentScorer</h1>
            <div class="nav-links">
                <button class="nav-btn active" onclick="showView('dashboard')">Dashboard</button>
                <button class="nav-btn" onclick="showView('compare')">Compare</button>
                <button class="nav-btn" onclick="showView('add')">+ Add Apartment</button>
            </div>
        </div>
    </nav>

    <!-- DASHBOARD -->
    <div id="dashboard-view" class="view active">
        <div class="dashboard-header">
            <h2>Your Apartments</h2>
            <div class="sort-controls">
                <label>Sort by:</label>
                <select id="sort-select" onchange="sortApartments()">
                    <option value="overall">Overall Score</option>
                    <option value="price">Price Score</option>
                    <option value="rooms">Rooms Score</option>
                    <option value="necessities">Necessities</option>
                    <option value="nice_to_haves">Nice-to-Haves</option>
                    <option value="schools">Schools</option>
                    <option value="crime">Safety</option>
                    <option value="restaurants">Restaurants</option>
                    <option value="commute">Commute</option>
                    <option value="nightlife">Nightlife</option>
                    <option value="grocery">Grocery</option>
                    <option value="rent">Rent (lowest)</option>
                </select>
            </div>
        </div>
        <div id="apartment-grid" class="apartment-grid"></div>
    </div>

    <!-- PDP -->
    <div id="pdp-view" class="view">
        <button class="back-btn" onclick="showView('dashboard')">‚Üê Back to All Apartments</button>
        <div class="pdp-container">
            <div class="pdp-header">
                <div class="pdp-title-section">
                    <h2 id="pdp-name" class="pdp-name"></h2>
                    <p id="pdp-address" class="pdp-address"></p>
                    <a id="pdp-url" class="pdp-link" href="#" target="_blank">View Original Listing ‚Üí</a>
                </div>
                <div class="pdp-overall-score">
                    <div id="pdp-score-circle" class="score-circle large">
                        <span id="pdp-overall-number" class="score-number"></span>
                    </div>
                    <p class="score-label">Overall Score</p>
                </div>
            </div>
            <div class="pdp-details-bar">
                <div class="detail-item"><span class="detail-label">Rent</span><span id="pdp-rent" class="detail-value"></span></div>
                <div class="detail-item"><span class="detail-label">Layout</span><span id="pdp-layout" class="detail-value"></span></div>
                <div class="detail-item"><span class="detail-label">Sq Ft</span><span id="pdp-sqft" class="detail-value"></span></div>
                <div class="detail-item"><span class="detail-label">Commute</span><span id="pdp-commute-time" class="detail-value"></span></div>
            </div>
            <div class="pdp-scores-section"><h3>Score Breakdown</h3><div id="pdp-score-bars" class="score-bars"></div></div>
            <div class="pdp-amenities-section">
                <h3>Amenities</h3>
                <div class="amenities-columns">
                    <div class="amenity-col"><h4>‚úÖ Necessities</h4><ul id="pdp-necessities"></ul></div>
                    <div class="amenity-col"><h4>‚≠ê Nice-to-Haves</h4><ul id="pdp-nice-to-haves"></ul></div>
                </div>
            </div>
            <div id="pdp-tour-section" class="pdp-tour-section" style="display:none;">
                <h3>3D Tour</h3>
                <a id="pdp-tour-link" href="#" target="_blank" class="tour-btn">üé• Launch Virtual Tour</a>
            </div>
            <div class="pdp-neighborhood-section"><h3>Neighborhood Highlights</h3><div id="pdp-neighborhood-details" class="neighborhood-grid"></div></div>
            <div class="pdp-edit-section" style="padding:32px; border-top: 1px solid #f0f0f0;">
                <h3>Edit Details</h3>
                <p style="color:#6e6e73; font-size:14px; margin-bottom:16px;">Adjust any auto-detected values that need correction</p>
                <div id="pdp-edit-form"></div>
            </div>
        </div>
    </div>

    <!-- COMPARE -->
    <div id="compare-view" class="view">
        <h2>Compare Apartments</h2>
        <div class="compare-selector">
            <p>Select apartments to compare:</p>
            <div id="compare-checkboxes" class="compare-checkboxes"></div>
            <button class="compare-btn" onclick="runComparison()">Compare Selected</button>
        </div>
        <div id="compare-table-container" class="compare-table-container"></div>
    </div>

    <!-- ADD APARTMENT -->
    <div id="add-view" class="view">
        <h2>Add New Apartment</h2>

        <!-- PASTE SOURCE METHOD -->
        <div class="form-section" id="source-input-section">
            <h3>Paste from Apartments.com</h3>
            <p class="form-note">3 easy steps:</p>
            <div style="background:#f5f5f7; border-radius:12px; padding:16px; margin-bottom:16px; font-size:14px; line-height:1.8;">
                <strong>1.</strong> Go to the apartment listing on apartments.com<br>
                <strong>2.</strong> Right-click anywhere ‚Üí "View Page Source"<br>
                <strong>3.</strong> Press Ctrl+A (select all), then Ctrl+C (copy), then paste below
            </div>
            <div class="form-group">
                <label>Listing URL (for your reference)</label>
                <input type="url" id="input-url" placeholder="https://www.apartments.com/...">
            </div>
            <div class="form-group">
                <label>Page Source Code</label>
                <textarea id="input-source" rows="6" 
                    style="width:100%; padding:12px; border:1px solid #d2d2d7; border-radius:10px; font-family:monospace; font-size:12px; resize:vertical;"
                    placeholder="Paste the entire page source here..."></textarea>
            </div>
            <button class="submit-btn" onclick="scoreFromSource()" id="score-btn">
                Score This Apartment üéØ
            </button>
            <div id="score-status" style="margin-top:16px; display:none;"></div>
        </div>

        <!-- MANUAL FALLBACK -->
        <div id="manual-section" style="display:none;">
            <div class="form-section">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Complete the Details</h3>
                    <span style="color:#6e6e73; font-size:13px;">Fields marked with * are required</span>
                </div>
                <p class="form-note" id="manual-reason"></p>
                <div class="form-group">
                    <label>Apartment Name *</label>
                    <input type="text" id="input-name" placeholder="e.g., The Fred Apartments">
                </div>
                <div class="form-group">
                    <label>Address *</label>
                    <input type="text" id="input-address" placeholder="e.g., 4660 W 77th St, Edina, MN 55435">
                </div>
                <div class="form-row">
                    <div class="form-group"><label>Monthly Rent ($) *</label><input type="number" id="input-rent" placeholder="2200"></div>
                    <div class="form-group"><label>Bedrooms</label><input type="number" id="input-beds" value="2"></div>
                    <div class="form-group"><label>Bathrooms</label><input type="number" id="input-baths" value="2"></div>
                    <div class="form-group"><label>Square Footage</label><input type="number" id="input-sqft" placeholder="1050"></div>
                </div>
            </div>
            <div class="form-section">
                <h3>Amenities</h3>
                <h4 style="margin-bottom:8px;">Necessities</h4>
                <p class="form-note">‚ö†Ô∏è Missing any = 0 score</p>
                <div class="checkbox-grid" style="margin-bottom:20px;">
                    <label class="checkbox-item necessity"><input type="checkbox" name="amenity" value="covered_parking"> Covered Parking</label>
                    <label class="checkbox-item necessity"><input type="checkbox" name="amenity" value="dishwasher"> Dishwasher</label>
                    <label class="checkbox-item necessity"><input type="checkbox" name="amenity" value="in_unit_laundry"> In-Unit Laundry</label>
                    <label class="checkbox-item necessity"><input type="checkbox" name="amenity" value="ac"> Air Conditioning</label>
                </div>
                <h4 style="margin-bottom:8px;">Nice-to-Haves</h4>
                <div class="checkbox-grid">
                    <label class="checkbox-item"><input type="checkbox" name="amenity" value="pool"> Pool</label>
                    <label class="checkbox-item"><input type="checkbox" name="amenity" value="sauna_hot_tub"> Sauna / Hot Tub</label>
                    <label class="checkbox-item"><input type="checkbox" name="amenity" value="gym"> Gym / Fitness</label>
                    <label class="checkbox-item"><input type="checkbox" name="amenity" value="package_lockers"> Package Lockers</label>
                </div>
            </div>
            <div class="form-section">
                <h3>3D Tour (optional)</h3>
                <div class="form-group"><input type="url" id="input-tour" placeholder="https://my.matterport.com/..."></div>
            </div>
            <button class="submit-btn" onclick="scoreManual()">Score This Apartment üéØ</button>
        </div>

        <p style="text-align:center; margin-top:16px;">
            <a href="#" onclick="showManualForm('Enter details manually')" style="color:#0071e3; font-size:14px;">Or enter details manually ‚Üí</a>
        </p>
    </div>

    <script src="app.js"></script>
</body>
</html>
